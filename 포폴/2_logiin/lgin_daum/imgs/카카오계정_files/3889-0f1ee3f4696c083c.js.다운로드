"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3889],{66242:function(e,t,i){i.d(t,{Uu:function(){return S},xC:function(){return T}});var n=i(50029),r=i(59499),s=i(4730),o=i(87757),a=i.n(o),c=i(67294),l=i(71217),u=i(33727),d=i(47008),h=i(69532),f=i(42197),m=i(32979),p=i(95939),v=i(8895),_=i(10016),x=i(80144),y=i(85893),g=["type"];function k(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function j(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?k(Object(i),!0).forEach((function(t){(0,r.Z)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):k(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var S=(0,l.Pi)((function(e){var t=e.store;switch((0,c.useEffect)((function(){t.loadDialogs("action_penalty_verification",N)}),[]),t.step){case"verifyTmsForActionPenalty":return(0,y.jsx)(b,{timer:t.tmsTimer,maskedPhoneNumber:t.maskedPhoneNumber,canOtherMethod:t.canOtherMethod,showGuideVerification:function(e){return t.showGuideVerification(e)},gotoSelectVerificationMethod:function(){return t.gotoSelectVerificationMethod()},gotoStart:function(){return t.gotoStart()}});case"selectVerificationMethodForActionPenalty":return(0,y.jsx)(Z,{isCertifiable:t.isCertifiable,hasEmails:t.hasEmails,requestVerify:function(e){return t.requestVerify(e)},confirmVerify:function(){return t.confirmVerify()},gotoEmailPasscode:function(){return t.startWithEmail()},showGuideVerification:function(e){return t.showGuideVerification(e)}});case"noVerificationMethodForActionPenalty":return(0,y.jsx)(P,{gotoStart:function(){return t.gotoStart()},openGuide:function(e){return t.openGuide(e)}});case"selectEmailForActionPenalty":return(0,y.jsx)(C,{emails:t.emails,onSubmit:function(e){t.requestEmailPasscode(e)},gotoSelectVerificationMethod:function(){return t.gotoSelectVerificationMethod()}});case"verifyEmailPasscodeForActionPenalty":return(0,y.jsx)(w,{timer:t.emailTimer,email:t.email,onSubmit:function(e){t.verifyEmailPasscode(e)},gotoStart:function(){return t.gotoStart()},onResend:function(e){t.dialogs.resendEmail((function(){t.resendEmailPasscode(e)}))}});case"notReleasable":return(0,y.jsx)(E,{gotoStart:function(){return t.gotoStart()}});default:return null}}));function N(e){var t=e.type,i=(0,s.Z)(e,g);switch(t){case"timeout":return(0,y.jsx)(h.uc,j({scope:"dialog.timeout"},i));case"guideVerification":return(0,y.jsx)(h.UO,j({scope:"dialog.guide_action_penalty_verification"},i));case"resendEmail":return(0,y.jsx)(h.UO,j({scope:"dialog.resend_email_passcode"},i));default:return null}}var b=(0,l.Pi)((function(e){var t=e.timer,i=e.maskedPhoneNumber,n=e.canOtherMethod,r=e.showGuideVerification,s=e.gotoSelectVerificationMethod,o=e.gotoStart,a=(0,f.Z)({scope:"action_penalty_verification.tms"}).t,c=(0,m.u)("action_penalty_guide").action_penalty_guide,l=(0,u.Z)({timer:t}),h=l.time,p=l.humanizeTime;return(0,y.jsx)(d.Z,{children:(0,y.jsxs)("div",{className:"cont_addcertify",children:[(0,y.jsx)("h2",{className:"tit_g tit_certify",children:a("title")}),(0,y.jsxs)("div",{className:"login_certify",children:[(0,y.jsx)("p",{className:"desc_g",children:a("desc")}),(0,y.jsx)("button",{type:"button",className:"link_comm","aria-haspopup":"true",onClick:function(){return r(c)},children:a("guide")}),(0,y.jsxs)("div",{className:"box_certify",children:[(0,y.jsx)("span",{className:"screen_out",children:a("screen_out.phone")}),(0,y.jsx)("strong",{className:"info_address",children:i}),(0,y.jsxs)("span",{className:"txt_time",role:"text",children:[(0,y.jsx)("span",{children:a("remains")}),(0,y.jsx)("span",{children:" "}),(0,y.jsx)("span",{"aria-hidden":"true",children:h}),(0,y.jsx)("span",{className:"screen_out",children:p})]})]}),n?(0,y.jsx)("div",{className:"area_etc align_center",children:(0,y.jsx)("a",{onClick:s,className:"link_comm",children:a("link")})}):(0,y.jsx)("div",{className:"area_etc align_center",children:(0,y.jsx)("a",{onClick:o,className:"link_comm",children:a("go_to_start")})})]})]})})})),Z=(0,l.Pi)((function(e){var t=e.isCertifiable,i=e.hasEmails,r=e.requestVerify,s=e.confirmVerify,o=e.gotoEmailPasscode,l=e.showGuideVerification,u=(0,f.Z)({scope:"action_penalty_verification.verify_methods"}).t,h=(0,m.u)("action_penalty_guide").action_penalty_guide;return(0,c.useEffect)((function(){var e=function(){var e=(0,n.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"closed"===t.data&&s();case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return window.addEventListener("message",e,!1),function(){window.removeEventListener("message",e)}}),[]),(0,y.jsx)(d.Z,{children:(0,y.jsxs)("div",{className:"cont_addcertify",children:[(0,y.jsx)("h2",{className:"tit_g",children:u("title")}),(0,y.jsxs)("div",{className:"other_certify",children:[(0,y.jsxs)("div",{className:"wrap_find",children:[(0,y.jsx)("strong",{className:"screen_out",children:u("screen_out")}),t&&(0,y.jsxs)("div",{className:"group_prove",children:[(0,y.jsx)("strong",{className:"tit_find",children:u("certificate.title")}),(0,y.jsxs)("ul",{className:"list_prove",children:[(0,y.jsx)("li",{children:(0,y.jsx)("a",{className:"link_prove",onClick:function(){return r()},children:(0,y.jsx)("span",{className:"innder_link",children:(0,y.jsxs)("span",{className:"txt_prove",children:[(0,y.jsx)("span",{className:"ico_comm ico_cellphone"}),u("certificate.phone")]})})})}),(0,y.jsx)("li",{children:(0,y.jsx)("a",{className:"link_prove",onClick:function(){return r("card")},children:(0,y.jsx)("span",{className:"innder_link",children:(0,y.jsxs)("span",{className:"txt_prove",children:[(0,y.jsx)("span",{className:"ico_comm ico_card"}),u("certificate.card")]})})})})]})]}),i&&(0,y.jsxs)("div",{className:"group_prove",children:[(0,y.jsx)("strong",{className:"tit_find",children:u("registered_email.title")}),(0,y.jsx)("ul",{className:"list_prove",children:(0,y.jsx)("li",{children:(0,y.jsx)("a",{className:"link_prove",onClick:o,children:(0,y.jsx)("span",{className:"innder_link",children:(0,y.jsxs)("span",{className:"txt_prove",children:[(0,y.jsx)("span",{className:"ico_comm ico_mail"}),u("email.title")]})})})})})]})]}),(0,y.jsx)("div",{className:"area_etc",children:(0,y.jsx)("a",{className:"link_comm",onClick:function(){return l(h)},children:u("guide")})})]})]})})})),P=(0,l.Pi)((function(e){var t=e.gotoStart,i=e.openGuide,n=(0,f.Z)({scope:"action_penalty_verification.no_methods"}).t,r=(0,m.u)("action_penalty_guide").action_penalty_guide;return(0,y.jsx)(d.Z,{children:(0,y.jsx)("div",{className:"cont_addcertify",children:(0,y.jsxs)("div",{className:"inner_error inner_error_type2",children:[(0,y.jsxs)("div",{className:"wrap_error",children:[(0,y.jsx)("span",{className:"ico_accountcheck ico_error"}),(0,y.jsx)("strong",{className:"tit_error",children:n("title")}),(0,y.jsx)("p",{className:"desc_error",children:n("desc1")}),(0,y.jsx)("p",{className:"desc_error",children:n("desc2")}),(0,y.jsx)("p",{className:"desc_error",children:n("desc3")})]}),(0,y.jsx)(x.Z,{onClick:t,children:n("go_to_start")}),(0,y.jsx)("div",{className:"area_etc align_center",children:(0,y.jsx)("a",{className:"link_comm",onClick:function(){return i(r)},children:n("guide")})})]})})})})),C=(0,l.Pi)((function(e){var t=e.emails,i=e.onSubmit,n=e.gotoSelectVerificationMethod,r=(0,f.Z)({scope:"action_penalty_verification.select_email"}).t,s=(0,p.cI)({fields:[{name:"email",type:"radio",validator:v.kI.not_blank}],values:{email:t.length>0?t[0].email:""},onSubmit:i});return(0,y.jsx)(d.Z,{children:(0,y.jsxs)("div",{className:"cont_addcertify",children:[(0,y.jsx)("h2",{className:"tit_g tit_certify",children:r("title")}),(0,y.jsx)("p",{className:"desc_g",children:r("desc")}),(0,y.jsx)("div",{className:"login_certify",children:(0,y.jsxs)("form",{onSubmit:s.onSubmit,children:[(0,y.jsxs)("div",{className:"box_certify",children:[(0,y.jsx)("strong",{className:"tit_box",children:r("email")}),(0,y.jsx)("div",{className:"wrap_inp",children:t&&t.map((function(e,t){return(0,y.jsx)(_.ig,{id:"r_email_".concat(t),field:s.$("email"),label:e.maskedEmail,value:e.email},t)}))})]}),(0,y.jsx)("div",{className:"confirm_btn",children:(0,y.jsx)(_.BF,{form:s,highlighted:!1,children:r("confirm")})}),(0,y.jsx)("a",{className:"link_certify",onClick:n,children:r("link")})]})})]})})})),w=(0,l.Pi)((function(e){var t=e.timer,i=e.email,n=e.onResend,r=e.gotoStart,s=e.onSubmit,o=(0,f.Z)({scope:"action_penalty_verification.email"}).t,a=[p.FU.emailPasscode],c=(0,p.cI)({fields:a,onSubmit:s}),l=(0,u.Z)({timer:t}),h=l.time,m=l.humanizeTime;return(0,y.jsx)(d.Z,{children:(0,y.jsxs)("div",{className:"cont_addcertify",children:[(0,y.jsx)("h2",{className:"tit_g tit_certify",children:(0,y.jsxs)("span",{className:"inner_tit",role:"text",children:[(0,y.jsx)("span",{className:"txt_tit",children:o("title1")}),(0,y.jsx)("span",{className:"txt_tit",children:o("title2")})]})}),(0,y.jsxs)("div",{className:"login_certify",children:[(0,y.jsxs)("form",{onSubmit:c.onSubmit,children:[(0,y.jsxs)("div",{className:"box_certify",children:[(0,y.jsx)("span",{className:"screen_out",children:o("screen_out")}),(0,y.jsxs)("strong",{className:"info_address",children:[" ",i.maskedEmail," "]}),(0,y.jsxs)("span",{className:"txt_time",role:"text",children:[(0,y.jsx)("span",{children:o("remains")}),(0,y.jsx)("span",{children:" "}),(0,y.jsx)("span",{"aria-hidden":"true",children:h}),(0,y.jsx)("span",{className:"screen_out",children:m})]})]}),(0,y.jsx)(_.Xt,{field:c.$(p.FU.emailPasscode.name),right:{type:"button",text:o("resend"),onClick:function(){return n(c)}},autoFocus:!0}),(0,y.jsx)("div",{className:"confirm_btn",children:(0,y.jsx)(_.BF,{form:c,highlighted:!1,children:o("confirm")})})]}),(0,y.jsx)("a",{className:"link_certify",onClick:function(e){e.preventDefault(),r()},children:o("go_to_start")})]})]})})})),T=(0,l.Pi)((function(e){var t=e.store;switch(t.step){case"verifyWithToken":return(0,y.jsx)(A,{deviceInfo:t.actionPenaltyVerificationWithTokenContext.deviceInfo,serviceName:t.actionPenaltyVerificationWithTokenContext.serviceName,onConfirm:function(){return t.onConfirm()},onBlock:function(){return t.onBlock()}});case"confirmed":return(0,y.jsx)(V,{gotoSetTwoStepVerification:function(){return t.gotoSetTwoStepVerification()},onClose:function(){return t.onClose()}});case"blocked":return(0,y.jsx)(O,{gotoChangePassword:function(){return t.gotoChangePassword()},onClose:function(){return t.onClose()}});case"invalidToken":return(0,y.jsx)(F,{onClose:function(){return t.onClose()}})}return null})),E=(0,l.Pi)((function(e){var t=e.gotoStart,i=(0,f.Z)({scope:"action_penalty_verification.delayed"}).t,n=(0,m.u)("action_penalty_guide","request_cs"),r=n.action_penalty_guide,s=n.request_cs;return(0,y.jsx)(d.Z,{children:(0,y.jsx)("div",{className:"cont_addcertify",children:(0,y.jsxs)("div",{className:"inner_error inner_error_type2 certify_delay",children:[(0,y.jsxs)("div",{className:"wrap_error",children:[(0,y.jsx)("span",{className:"ico_accountcheck ico_error"}),(0,y.jsxs)("strong",{className:"tit_error",children:[i("title1"),(0,y.jsx)("br",{}),i("title2")]}),(0,y.jsxs)("p",{className:"desc_error",children:[i("desc1"),(0,y.jsx)("br",{}),i("desc2")]}),(0,y.jsxs)("p",{className:"desc_error",children:[i("desc3")," ",(0,y.jsxs)("a",{href:r,target:"_blank",rel:"noreferrer",className:"link_g emph_color",children:[i("help")," ",(0,y.jsx)("span",{className:"screen_out",children:i("screen_out")})]}),i("desc4")]}),(0,y.jsxs)("p",{className:"desc_error",children:[i("desc5"),(0,y.jsx)("br",{}),(0,y.jsxs)("a",{href:s,target:"_blank",rel:"noreferrer",className:"link_g emph_color",children:[i("cs"),(0,y.jsx)("span",{className:"screen_out",children:i("screen_out")})]}),i("desc7")]})]}),(0,y.jsx)(x.Z,{onClick:t,children:i("confirm")})]})})})})),A=(0,l.Pi)((function(e){var t=e.deviceInfo,i=e.serviceName,n=e.onConfirm,r=e.onBlock,s=(0,f.Z)({scope:"verify_tms_token"}).t;return(0,y.jsx)(d.Z,{children:(0,y.jsx)("div",{className:"cont_addcertify",children:(0,y.jsxs)("div",{className:"certify_tms",children:[(0,y.jsx)("h2",{className:"tit_g tit_certify",children:s("title")}),(0,y.jsx)("p",{className:"desc_g",children:s("desc1")}),(0,y.jsx)("p",{className:"desc_g",children:s("desc2")}),(0,y.jsxs)("dl",{className:"list_device",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("dt",{children:s("date")}),(0,y.jsx)("dd",{children:s("just_now")})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("dt",{children:s("device")}),(0,y.jsx)("dd",{children:t})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("dt",{children:s("service")}),(0,y.jsx)("dd",{children:i})]})]}),(0,y.jsx)("div",{className:"confirm_btn",children:(0,y.jsx)(x.Z,{onClick:n,highlighted:!0,children:s("confirm")})}),(0,y.jsx)("div",{className:"area_etc align_center",children:(0,y.jsx)("a",{onClick:r,className:"link_comm",children:s("block")})})]})})})})),V=(0,l.Pi)((function(e){var t=e.gotoSetTwoStepVerification,i=e.onClose,n=(0,f.Z)({scope:"confirmed"}).t;return(0,y.jsx)(d.Z,{children:(0,y.jsx)("div",{className:"cont_addcertify",children:(0,y.jsxs)("div",{className:"certify_tms",children:[(0,y.jsx)("h2",{className:"tit_g tit_certify",children:n("title")}),(0,y.jsx)("p",{className:"desc_g",children:n("desc")}),(0,y.jsxs)("div",{className:"box_tip",children:[(0,y.jsxs)("strong",{className:"tit_tip",children:[(0,y.jsx)("span",{className:"txt_tip",children:n("tip")}),n("tip.title")]}),(0,y.jsx)("p",{className:"desc_tip",children:n("tip.desc")}),(0,y.jsx)("a",{onClick:t,className:"link_tip",children:n("tip.set_two_step_verification")})]}),(0,y.jsx)("div",{className:"confirm_btn",children:(0,y.jsx)(x.Z,{onClick:i,children:n("confirm")})})]})})})})),O=(0,l.Pi)((function(e){var t=e.gotoChangePassword,i=e.onClose,n=(0,f.Z)({scope:"blocked"}).t;return(0,y.jsx)(d.Z,{children:(0,y.jsx)("div",{className:"cont_addcertify",children:(0,y.jsxs)("div",{className:"certify_tms",children:[(0,y.jsx)("h2",{className:"tit_g tit_certify",children:n("title")}),(0,y.jsx)("p",{className:"desc_g",children:n("desc1")}),(0,y.jsx)("p",{className:"desc_g",children:n("desc2")}),(0,y.jsxs)("div",{className:"confirm_btn",children:[(0,y.jsx)(x.Z,{highlighted:!0,onClick:t,children:n("change_password")}),(0,y.jsx)(x.Z,{onClick:i,children:n("close")})]})]})})})})),F=(0,l.Pi)((function(e){var t=e.onClose,i=(0,f.Z)({scope:"invalid"}).t;return(0,y.jsx)(d.Z,{children:(0,y.jsx)("div",{className:"cont_addcertify",children:(0,y.jsxs)("div",{className:"inner_error inner_error_type2",children:[(0,y.jsxs)("div",{className:"wrap_error",children:[(0,y.jsx)("span",{className:"ico_accountcheck ico_error"})," ",(0,y.jsx)("strong",{className:"tit_error",children:i("title")}),(0,y.jsxs)("p",{className:"desc_error",children:[i("desc1")," ",(0,y.jsx)("br",{}),i("desc2")]}),(0,y.jsxs)("p",{className:"desc_error",children:[i("desc3")," ",(0,y.jsx)("br",{}),i("desc4")]})]}),(0,y.jsx)(x.Z,{onClick:t,children:i("confirm")})]})})})}))},33727:function(e,t,i){i.d(t,{Z:function(){return a}});var n=i(67294),r=i(69695),s=i.n(r),o=i(42197);function a(e){var t=e.timer;(0,n.useEffect)((function(){return t.start(),function(){t.destory()}}),[]);var i=t.remainTime,r=t.remainSeconds,a=(0,o.Z)().locale;return{time:i,humanizeTime:s()(1e3*r,{language:a,fallbacks:["en"]})}}},71479:function(e,t,i){i.d(t,{hk:function(){return S},t5:function(){return j}});var n=i(50029),r=i(92777),s=i(82262),o=i(10748),a=i(74450),c=i(45959),l=i(63553),u=i(37247),d=i(59499),h=i(87757),f=i.n(h),m=i(85009),p=i(19059),v=i(92554),_=i(19468),x=i(95939);function y(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function g(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?y(Object(i),!0).forEach((function(t){(0,d.Z)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):y(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function k(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=(0,u.Z)(e);if(t){var r=(0,u.Z)(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return(0,l.Z)(this,i)}}var j=function(e){(0,c.Z)(i,e);var t=k(i);function i(e){var n;(0,r.Z)(this,i),n=t.call(this,e),(0,d.Z)((0,o.Z)(n),"dialogs",void 0),(0,d.Z)((0,o.Z)(n),"startPage",""),(0,d.Z)((0,o.Z)(n),"startUrl",""),(0,d.Z)((0,o.Z)(n),"maskedPhoneNumber",""),(0,d.Z)((0,o.Z)(n),"isCertifiable",!1),(0,d.Z)((0,o.Z)(n),"hasEmails",!1),(0,d.Z)((0,o.Z)(n),"canOtherMethod",!1),(0,d.Z)((0,o.Z)(n),"emails",[]),(0,d.Z)((0,o.Z)(n),"email",void 0),(0,d.Z)((0,o.Z)(n),"token",""),(0,d.Z)((0,o.Z)(n),"tmsTimer",void 0),(0,d.Z)((0,o.Z)(n),"emailTimer",void 0),n.dialogs=new N(n.dialogStore);var s={format:"mm:ss",onTimeout:function(){return n.onTimeout()}};return n.tmsTimer=new _.B(g(g({},s),{},{polling:{pollingApi:function(){return n.pollTms()}}})),n.emailTimer=new _.B(s),(0,o.Z)(n).initTiaraWith("ActionPenaltyVerification",b),n}return(0,s.Z)(i,[{key:"startFromLogin",value:function(e){switch(this.startPage=this.step,this.maskedPhoneNumber=e.maskedPhoneNumber,this.isCertifiable=e.isCertifiable,this.emails=e.emails,this.canOtherMethod=e.canOtherMethod,this.emails.length>0&&(this.hasEmails=!0),e.viewType){case"tms_verify":this.startWithTms();break;case"select_verification":this.gotoSelectVerificationMethod();break;case"email_select":this.startWithEmail()}}},{key:"startFromCertificate",value:function(){var e=this.contextAs();return this.token=e.token,this.startUrl=e.startUrl,this.confirmVerify(),this}},{key:"gotoStart",value:function(){this.startPage?this.pageStore.backUntil(this.startPage,{clear:!0}):this.startUrl?this.router.moveTo(this.startUrl,!0):location.reload()}},{key:"nextStep",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t,r=["selectEmailForActionPenalty","selectVerificationMethodForActionPenalty","noVerificationMethodForActionPenalty"];(r.includes(e)||this.step===this.startPage)&&(this.startPage&&this.pageStore.clear(this.startPage),n=g(g({},t),{},{blockForward:!0,back:this.startPage})),(0,a.Z)((0,u.Z)(i.prototype),"nextStep",this).call(this,e,n)}},{key:"onComplete",value:function(e){this.router.moveTo(e.continueUrl,!0)}},{key:"onTimeout",value:function(){var e=this;this.dialogs.timeout((function(){return e.gotoStart()}))}},{key:"startWithTms",value:function(){var e=this;this.client.call("send_tms_for_action_penalty_verification").then((function(t){if(t.status===v.Z.SUCCESS)e.token=t.token,e.nextStep("verifyTmsForActionPenalty"),e.tmsTimer.init({timeout:t.expireSeconds});else e.dialogs.errorAlert(t,(function(){return e.gotoStart()}))}))}},{key:"pollTms",value:function(){var e=(0,n.Z)(f().mark((function e(){var t,i,n=this;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.client.call("check_tms_for_action_penalty_verification",{token:this.token});case 2:t=e.sent,e.t0=t.status,e.next=e.t0===v.Z.SUCCESS?6:e.t0===v.Z.ACTION_PENALTY_VERIFICATION_WAIT?17:18;break;case 6:return e.next=8,this.client.call("expire_tms_for_action_penalty_verification",{token:this.token});case 8:i=e.sent,e.t1=i.status,e.next=e.t1===v.Z.SUCCESS||e.t1===v.Z.EXPIRED_VERIFY_TOKEN?12:14;break;case 12:return this.onComplete(t),e.abrupt("break",16);case 14:case 18:return this.dialogs.errorAlert(t,(function(){return n.gotoStart()})),e.abrupt("return",!1);case 16:return e.abrupt("return",!1);case 17:return e.abrupt("return",!0);case 20:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"showGuideVerification",value:function(e){this.dialogs.guideVerification((function(){return window.open(e,"_blank")}))}},{key:"openGuide",value:function(e){window.open(e,"_blank")}},{key:"gotoSelectVerificationMethod",value:function(){this.hasEmails||this.isCertifiable?this.nextStep("selectVerificationMethodForActionPenalty"):this.nextStep("noVerificationMethodForActionPenalty")}},{key:"startWithEmail",value:function(){this.nextStep("selectEmailForActionPenalty")}},{key:"requestEmailPasscode",value:function(e){var t=this,i=e.values().email;this.client.call("send_passcode_for_action_penalty_verification",{email:i,reissue:!1}).then((function(e){if(e.status===v.Z.SUCCESS)t.email=t.emails.find((function(e){return e.email===i})),t.token=e.token,t.nextStep("verifyEmailPasscodeForActionPenalty"),t.emailTimer.init({timeout:e.expireSeconds});else t.dialogs.errorAlert(e,(function(){return t.gotoStart()}))}))}},{key:"resendEmailPasscode",value:function(e){var t,i=this;this.client.call("send_passcode_for_action_penalty_verification",{email:null===(t=this.email)||void 0===t?void 0:t.email,reissue:!0}).then((function(t){if(t.status===v.Z.SUCCESS)e.clearField(x.FU.emailPasscode.name),i.token=t.token,i.emailTimer.init({timeout:t.expireSeconds});else i.dialogs.errorAlert(t,(function(){return i.gotoStart()}))}))}},{key:"verifyEmailPasscode",value:function(e){var t,i=this;this.client.call("check_passcode_for_action_penalty_verification",g({email:null===(t=this.email)||void 0===t?void 0:t.email,token:this.token},e.values())).then((function(t){switch(t.status){case v.Z.SUCCESS:i.router.moveTo(t.continueUrl,!0);break;case v.Z.INVALID_PASSCODE:i.dialogs.errorAlert(t,(function(){return e.clearAndFocus(x.FU.emailPasscode.name)}));break;default:i.dialogs.errorAlert(t,(function(){return i.gotoStart()}))}}))}},{key:"requestVerify",value:function(e){var t=this;this.client.call("prepare_verify_for_action_penalty_verification",{method:e}).then((function(e){if(e.status===v.Z.SUCCESS)if(t.token=e.token,t.rootStore.isMobile)t.router.moveTo(e.verifyStartUrl);else{var i=window.open("","kaccount_verify_identity","app_, width=500, height=850, resizable=no, scrollbars=yes, status=no;");i&&(i.location.href=e.verifyStartUrl)}else t.dialogs.errorAlert(e)}))}},{key:"confirmVerify",value:function(){var e=this;this.client.call("confirm_verify_for_action_penalty_verification",{token:this.token}).then((function(t){if(t.status===v.Z.SUCCESS)e.router.moveTo(t.continueUrl,!0);else e.gotoStart()}))}},{key:"startNotReleasable",value:function(){this.nextStep("notReleasable")}}]),i}(m.u),S=function(e){(0,c.Z)(i,e);var t=k(i);function i(e){var n,s;switch((0,r.Z)(this,i),null===(n=(s=t.call(this,e)).actionPenaltyVerificationWithTokenContext)||void 0===n?void 0:n.page){case"confirm":s.nextStep("verifyWithToken");break;case"block":s.onBlock();break;default:s.nextStep("invalidToken")}return s}return(0,s.Z)(i,[{key:"nextStep",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,a.Z)((0,u.Z)(i.prototype),"nextStep",this).call(this,e,g(g({},t),{},{changeHash:!1}))}},{key:"actionPenaltyVerificationWithTokenContext",get:function(){return this.contextAs()}},{key:"onConfirm",value:function(){var e=this;this.client.call("confirm_tms_for_action_penalty_verification",{token:this.actionPenaltyVerificationWithTokenContext.token,serviceFrom:this.actionPenaltyVerificationWithTokenContext.serviceName}).then((function(t){if(t.status===v.Z.SUCCESS)e.nextStep("confirmed");else e.nextStep("invalidToken")}))}},{key:"onBlock",value:function(){var e=this;this.client.call("block_tms_for_action_penalty_verification",{token:this.actionPenaltyVerificationWithTokenContext.token,serviceFrom:this.actionPenaltyVerificationWithTokenContext.serviceName}).then((function(t){if(t.status===v.Z.SUCCESS)e.nextStep("blocked");else e.nextStep("invalidToken")}))}},{key:"gotoSetTwoStepVerification",value:function(){this.router.goto("manage_two_step_verification")}},{key:"gotoChangePassword",value:function(){this.router.goto("change_password")}},{key:"onClose",value:function(){this.client.callIf("close").then()}}]),i}(m.u),N=function(e){(0,c.Z)(i,e);var t=k(i);function i(){return(0,r.Z)(this,i),t.apply(this,arguments)}return(0,s.Z)(i,[{key:"timeout",value:function(e){this.store.showDialog({type:"timeout",onSubmit:e,onClose:e})}},{key:"guideVerification",value:function(e){this.store.showDialog({type:"guideVerification",onSubmit:e})}},{key:"resendEmail",value:function(e){this.store.showDialog({type:"resendEmail",onSubmit:e})}}]),i}(p.v),b={verifyTmsForActionPenalty:"action-penalty-tms-login",selectVerificationMethodForActionPenalty:"action-penalty-verify-methods",noVerificationMethodForActionPenalty:"action-penalty-no-verify-method",selectEmailForActionPenalty:"action-penalty-email-login-select",verifyEmailPasscodeForActionPenalty:"action-penalty-email-login"}},85009:function(e,t,i){i.d(t,{u:function(){return c}});var n=i(92777),r=i(82262),s=i(59499),o=i(68949),a=i(66116),c=function(){function e(t){(0,n.Z)(this,e),(0,s.Z)(this,"rootStore",void 0),this.rootStore=t,(0,o.makeObservable)(this,{step:o.computed})}return(0,r.Z)(e,[{key:"currentForm",get:function(){return this.pageStore.getState()}},{key:"pageStore",get:function(){return this.rootStore.pageStore}},{key:"dialogStore",get:function(){return this.rootStore.dialogStore}},{key:"router",get:function(){return this.rootStore.router}},{key:"client",get:function(){return this.rootStore.client}},{key:"params",get:function(){return this.rootStore.params}},{key:"context",get:function(){return this.rootStore.context}},{key:"contextAs",value:function(){return this.rootStore.contextAs()}},{key:"links",get:function(){return this.rootStore.links}},{key:"loadDialogs",value:function(e,t){this.rootStore.dialogStore.addModule(e,t)}},{key:"tiara",get:function(){return this.rootStore.tiaraStore}},{key:"initTiaraWith",value:function(e,t){this.tiara.addTrack((0,a.$1)(e,t))}},{key:"initTiara",value:function(e){this.tiara.addTrack(e)}},{key:"page",get:function(){return this.pageStore.layout||""}},{key:"step",get:function(){return this.pageStore.page||""}},{key:"nextStep",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.pageStore.changePage(e,t)}},{key:"showError",value:function(e,t,i){t.errors?Object.keys(t.errors).forEach((function(i){e.$(i).invalidate(t.errors[i])})):this.dialogStore.errorAlert(t,i)}}]),e}()},19468:function(e,t,i){i.d(t,{B:function(){return h}});var n=i(50029),r=i(92777),s=i(82262),o=i(59499),a=i(87757),c=i.n(a),l=function(){function e(t){(0,r.Z)(this,e),(0,o.Z)(this,"config",void 0),(0,o.Z)(this,"errorCount",0),(0,o.Z)(this,"timeoutId",void 0),(0,o.Z)(this,"_stop",!1),this.config=t}return(0,s.Z)(e,[{key:"poll",value:function(){var e=this;if(!this._stop){var t=this.config.intervalSec||1;this.timeoutId=setTimeout((0,n.Z)(c().mark((function t(){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.config.pollingApi();case 3:t.sent?e.poll():e.stop(),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),e.errorCount++,e.poll();case 11:case"end":return t.stop()}}),t,null,[[0,7]])}))),1e3*t)}}},{key:"start",value:function(){this.timeoutId&&this.stop(),this._stop=!1,this.poll()}},{key:"stop",value:function(){this._stop=!0,this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=void 0)}}]),e}(),u=i(68949),d=i(83322),h=function(){function e(t){(0,r.Z)(this,e),(0,o.Z)(this,"config",void 0),(0,o.Z)(this,"startedAt",void 0),(0,o.Z)(this,"timeoutAt",void 0),(0,o.Z)(this,"currentSeconds",void 0),(0,o.Z)(this,"remainSeconds",void 0),(0,o.Z)(this,"intervalId",void 0),(0,o.Z)(this,"status","none"),(0,o.Z)(this,"poller",void 0),this.config=t,this.startedAt=-1,this.currentSeconds=-1,this.timeoutAt=-1,this.remainSeconds=-1,t.polling&&(this.poller=new l(t.polling)),(0,u.makeObservable)(this,{currentSeconds:u.observable,remainSeconds:u.observable,tick:u.action,init:u.action,start:u.action,stop:u.action,isStop:u.computed,remainTime:u.computed})}return(0,s.Z)(e,[{key:"isAfter",value:function(e){return this.currentSeconds-this.startedAt>=e}},{key:"remainTime",get:function(){var e=this.config.format;return e?(0,d.vc)(new Date(1e3*this.remainSeconds),e):this.remainSeconds.toString()}},{key:"isStop",get:function(){return"stop"===this.status}},{key:"tick",value:function(){this.isStop||(this.currentSeconds=this.toSeconds(Date.now()),this.calculate(),0===this.remainSeconds&&(this.config.onTimeout&&this.config.onTimeout(),this.stop()))}},{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.config;this.status="init",this.startedAt=this.toSeconds(Date.now()),this.timeoutAt=this.getTimeoutAt(e),this.currentSeconds=this.startedAt,this.calculate()}},{key:"start",value:function(){var e=this;"none"!==this.status&&"stop"!==this.status&&(this.status="running",this.destory(),this.intervalId=setInterval((function(){e.tick()}),1e3),this.poller&&this.poller.start())}},{key:"initAndStart",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.config;this.init(e),this.start()}},{key:"stop",value:function(){this.status="stop",this.destory()}},{key:"destory",value:function(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=void 0),this.poller&&this.poller.stop()}},{key:"calculate",value:function(){var e=this.timeoutAt-this.currentSeconds;this.remainSeconds=e>0?e:0}},{key:"toSeconds",value:function(e){return Math.floor(e/1e3)}},{key:"getTimeoutAt",value:function(e){return e.timeoutAt?e.timeoutAt:e.timeout?this.startedAt+e.timeout:0}}]),e}()}}]);